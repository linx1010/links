<h2 mat-dialog-title>{{ data.novoUser?.id ? 'Editar Recurso' : 'Cadastrar Recurso' }}</h2>

<mat-dialog-content>
  <form #form="ngForm" class="form-container">
    <!-- Nome -->
    <div class="form-group">
      <mat-form-field class="full-width">
        <mat-label>Nome</mat-label>
        <input matInput [(ngModel)]="data.novoUser.name" name="name" required>
      </mat-form-field>
    </div>

    <!-- Email -->
    <div class="form-group">
      <mat-form-field class="full-width">
        <mat-label>Email</mat-label>
        <input matInput [(ngModel)]="data.novoUser.email" name="email" required type="email">
      </mat-form-field>
    </div>

    <!-- Função -->
    <div class="form-group">
      <mat-form-field class="full-width">
        <mat-label>Função</mat-label>
        <mat-select [(ngModel)]="data.novoUser.role" name="role" required>
          <mat-option [value]="null">Nenhuma</mat-option>
          <mat-option *ngFor="let role of data.rolesPermitidas" [value]="role">
            {{ role }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Módulos -->
    <div class="form-group">
      <mat-form-field class="full-width">
        <mat-label>Módulos</mat-label>
        <mat-select [(ngModel)]="data.novoUser.modulos" name="modulos" multiple>
          <mat-option>
            <input
              matInput
              placeholder="Filtrar módulos..."
              [(ngModel)]="modulosFiltro"
              [ngModelOptions]="{standalone: true}"
              (keyup)="filtrarModulos()"
              style="width: 100%; padding: 4px;"
            />
          </mat-option>
          <mat-option *ngFor="let modulo of modulosFiltrados" [value]="modulo.code">
            {{ modulo.code }}: {{ modulo.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Valor-Hora -->
    <div class="form-group">
      <mat-form-field class="full-width">
        <mat-label>Valor-Hora</mat-label>
        <input matInput [(ngModel)]="data.novoUser.hourly_rate" name="hourly_rate" type="number">
      </mat-form-field>
    </div>
  </form>

  <!-- Tipo de Recurso -->
  <div class="form-group">
    <mat-form-field class="full-width">
      <mat-label>Tipo de Recurso</mat-label>
      <mat-select [(ngModel)]="data.novoUser.resource_type" name="resource_type" required (selectionChange)="onResourceTypeChange()">
        <mat-option value="hourly_full">Horista Integral</mat-option>
        <mat-option value="hourly_partial">Horista Parcial</mat-option>
        <mat-option value="scope">Escopo</mat-option>
        <mat-option value="full_time">Full</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Dias da Semana -->
  <div class="form-group">
    <mat-form-field class="full-width">
      <mat-label>Dias da Semana</mat-label>
      <mat-select [(ngModel)]="selectedDays" name="days" multiple (selectionChange)="updateQuartz()">
        <mat-option value="MON">Segunda</mat-option>
        <mat-option value="TUE">Terça</mat-option>
        <mat-option value="WED">Quarta</mat-option>
        <mat-option value="THU">Quinta</mat-option>
        <mat-option value="FRI">Sexta</mat-option>
        <mat-option value="SAT">Sábado</mat-option>
        <mat-option value="SUN">Domingo</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Horário -->
  <div class="form-group" *ngIf="data.novoUser.resource_type !== 'full_time'">
    <mat-form-field class="full-width">
      <mat-label>Hora</mat-label>
      <input matInput type="number" [(ngModel)]="selectedHour" name="hour" (input)="updateQuartz()" min="0" max="23">
    </mat-form-field>
  </div>

  <!-- Expressão Quartz (readonly) -->
  <div class="form-group">
    <mat-form-field class="full-width">
      <mat-label>Availability Expression</mat-label>
      <input matInput [(ngModel)]="data.novoUser.availability_expression" name="availability_expression" readonly>
    </mat-form-field>
  </div>

  
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancelar()">Cancelar</button>
  <button mat-flat-button color="primary" (click)="salvar()">Salvar</button>
</mat-dialog-actions>
