<mat-tab-group>
  <!-- Aba Dados Pessoais -->
  <mat-tab label="Dados Cadastrais">
  <div class="tab-content">
    <label>Nome:</label>
    <input [(ngModel)]="user.name" />

    <label>Email (login):</label>
    <input [(ngModel)]="user.email" />

    <label>Email cobrança:</label>
    <input [(ngModel)]="user.billing_email" />

    <label>Email financeiro:</label>
    <input [(ngModel)]="user.finance_email" />

    <label>Empresa:</label>
    <input [(ngModel)]="user.company_name" />

    <label>CNPJ:</label>
    <input [(ngModel)]="user.cnpj" />

    <!-- Endereço -->
    <label>CEP:</label>
    <input [(ngModel)]="user.cep" (blur)="buscarCep()" />

    <label>Rua:</label>
    <input [(ngModel)]="user.street" />

    <label>Número:</label>
    <input [(ngModel)]="user.number" />

    <label>Bairro:</label>
    <input [(ngModel)]="user.neighborhood" />

    <label>Cidade:</label>
    <input [(ngModel)]="user.city" />

    <label>Estado:</label>
    <input [(ngModel)]="user.state" />

    <button (click)="updateUser()">Salvar</button>
  </div>
</mat-tab>


  <!-- Aba Recebimento -->
  <mat-tab label="Recebimento">
    <div class="tab-content">
      <label>Banco:</label>
      <input [(ngModel)]="user.bank_name" />

      <label>Agência:</label>
      <input [(ngModel)]="user.bank_agency" />

      <label>Conta:</label>
      <input [(ngModel)]="user.bank_account" />

      <label>PIX:</label>
      <input [(ngModel)]="user.pix_key" />

      <button (click)="updateUser()">Salvar</button>
    </div>
  </mat-tab>

  <!-- Aba Módulos -->
  <mat-tab label="Módulos">
    <div class="tab-content">
      <table>
        <tr><th>Módulo</th><th>Proficiência</th></tr>
        <tr *ngFor="let mod of userModules">
          <td>{{ mod.module_code }}</td>
          <td>{{ mod.proficiency_score }}</td>
        </tr>
      </table>

      <h4>Adicionar Módulo</h4>
      <input #moduleCode placeholder="Código" />
      <select #score>
        <option *ngFor="let s of [1,2,3,4,5]" [value]="s">{{ s }}</option>
      </select>
      <button (click)="addModule(moduleCode.value, score.value)">Adicionar</button>
    </div>
  </mat-tab>

  <!-- Aba Contratos -->
  <mat-tab label="Contratos"*ngIf="featureContratosReady">
    <div class="tab-content">
      <table>
        <tr><th>Tipo</th><th>Valor Base</th><th>Multiplicador</th><th>Validade</th></tr>
        <tr *ngFor="let c of userContracts">
          <td>{{ c.contract_type }}</td>
          <td>{{ c.base_value }}</td>
          <td>{{ c.multiplier }}</td>
          <td>{{ c.valid_from }} - {{ c.valid_to }}</td>
        </tr>
      </table>

      <h4>Novo Contrato</h4>
      <!-- inputs para contrato -->
      <button (click)="addContract({contract_type:'full_time', base_value:1000, multiplier:1, valid_from:'2025-01-01'})">
        Adicionar
      </button>
    </div>
  </mat-tab>

  <!-- Aba Invoices -->
  <mat-tab label="Invoices" *ngIf="featureInvoicesReady">
    <div class="tab-content">
      <table>
        <tr><th>Número</th><th>Valor</th><th>Status</th><th>Arquivo</th></tr>
        <tr *ngFor="let inv of userInvoices">
          <td>{{ inv.invoice_number }}</td>
          <td>{{ inv.amount }}</td>
          <td>{{ inv.status }}</td>
          <td><a *ngIf="inv.file_path" [href]="inv.file_path" target="_blank">Ver NF</a></td>
        </tr>
      </table>

      <h4>Nova Invoice</h4>
      <input #invoiceNumber placeholder="Número" />
      <input #invoiceAmount type="number" placeholder="Valor" />
      <input type="file" (change)="onFileSelected($event)" />
      <button (click)="addInvoice({invoice_number: invoiceNumber.value, amount: invoiceAmount.value})">
        Adicionar
      </button>
    </div>
  </mat-tab>

 <mat-tab label="Senha">
  <div class="tab-content senha-tab">
    <h4>Alterar Senha</h4>

    <!-- Senha Atual -->
    <mat-form-field appearance="outline">
      <mat-label>Senha Atual</mat-label>
      <input matInput [type]="hideCurrent ? 'password' : 'text'" [(ngModel)]="currentPassword" required>
      <mat-icon matSuffix (click)="hideCurrent = !hideCurrent" class="eye-icon">
        {{ hideCurrent ? 'visibility_off' : 'visibility' }}
      </mat-icon>
      <mat-error *ngIf="!currentPassword">Informe sua senha atual</mat-error>
    </mat-form-field>

    <!-- Nova Senha -->
    <mat-form-field appearance="outline">
      <mat-label>Nova Senha</mat-label>
      <input matInput [type]="hideNew ? 'password' : 'text'" [(ngModel)]="newPassword" required>
      <mat-icon matSuffix (click)="hideNew = !hideNew" class="eye-icon">
        {{ hideNew ? 'visibility_off' : 'visibility' }}
      </mat-icon>
      <mat-error *ngIf="!newPassword">Informe a nova senha</mat-error>
    </mat-form-field>

    <!-- Repita Nova Senha -->
    <mat-form-field appearance="outline">
      <mat-label>Repita Nova Senha</mat-label>
      <input matInput [type]="hideRepeat ? 'password' : 'text'" [(ngModel)]="repeatPassword" required>
      <mat-icon matSuffix (click)="hideRepeat = !hideRepeat" class="eye-icon">
        {{ hideRepeat ? 'visibility_off' : 'visibility' }}
      </mat-icon>
      <mat-error *ngIf="repeatPassword && repeatPassword !== newPassword">
        As senhas não coincidem
      </mat-error>
    </mat-form-field>

    <button mat-raised-button color="primary" (click)="changePassword()">Alterar</button>
  </div>
</mat-tab>



</mat-tab-group>
